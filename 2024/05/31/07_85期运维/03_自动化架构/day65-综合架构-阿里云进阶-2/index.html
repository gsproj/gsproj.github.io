<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>day65-综合架构-阿里云进阶（二） | 迎风之豚的博客</title><meta name="author" content="Haris"><meta name="copyright" content="Haris"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="综合架构-阿里云进阶-02今日内容：  CLB&#x2F;ALB负载均衡 域名和DNS配置 HTTPS证书配置  一、CLB&#x2F;ALB负载均衡公有云的负载均衡一般都是现成的产品，一般不需要我们关注产品的底层实现 1.1 CLB和ALB概述负载均衡选型：  现成产品： CLB：传统型负载均衡，以前叫SLB ALB   也可以自己搭建：ECS * 2 + keepalived，需要提供VIP（">
<meta property="og:type" content="article">
<meta property="og:title" content="day65-综合架构-阿里云进阶（二）">
<meta property="og:url" content="http://gsproj.github.io/2024/05/31/07_85%E6%9C%9F%E8%BF%90%E7%BB%B4/03_%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%B6%E6%9E%84/day65-%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84-%E9%98%BF%E9%87%8C%E4%BA%91%E8%BF%9B%E9%98%B6-2/index.html">
<meta property="og:site_name" content="迎风之豚的博客">
<meta property="og:description" content="综合架构-阿里云进阶-02今日内容：  CLB&#x2F;ALB负载均衡 域名和DNS配置 HTTPS证书配置  一、CLB&#x2F;ALB负载均衡公有云的负载均衡一般都是现成的产品，一般不需要我们关注产品的底层实现 1.1 CLB和ALB概述负载均衡选型：  现成产品： CLB：传统型负载均衡，以前叫SLB ALB   也可以自己搭建：ECS * 2 + keepalived，需要提供VIP（">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://gsproj.github.io/img/%E7%BA%A2%E7%8C%AA.png">
<meta property="article:published_time" content="2024-05-31T08:08:52.000Z">
<meta property="article:modified_time" content="2024-08-02T01:48:34.361Z">
<meta property="article:author" content="Haris">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://gsproj.github.io/img/%E7%BA%A2%E7%8C%AA.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "day65-综合架构-阿里云进阶（二）",
  "url": "http://gsproj.github.io/2024/05/31/07_85%E6%9C%9F%E8%BF%90%E7%BB%B4/03_%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%B6%E6%9E%84/day65-%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84-%E9%98%BF%E9%87%8C%E4%BA%91%E8%BF%9B%E9%98%B6-2/",
  "image": "http://gsproj.github.io/img/%E7%BA%A2%E7%8C%AA.png",
  "datePublished": "2024-05-31T08:08:52.000Z",
  "dateModified": "2024-08-02T01:48:34.361Z",
  "author": [
    {
      "@type": "Person",
      "name": "Haris",
      "url": "http://gsproj.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://gsproj.github.io/2024/05/31/07_85%E6%9C%9F%E8%BF%90%E7%BB%B4/03_%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%B6%E6%9E%84/day65-%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84-%E9%98%BF%E9%87%8C%E4%BA%91%E8%BF%9B%E9%98%B6-2/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'day65-综合架构-阿里云进阶（二）',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load', preloader.endLoading)

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/吊床.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/%E7%BA%A2%E7%8C%AA.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">208</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">29</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/吊床.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">迎风之豚的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">day65-综合架构-阿里云进阶（二）</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">day65-综合架构-阿里云进阶（二）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-05-31T08:08:52.000Z" title="发表于 2024-05-31 16:08:52">2024-05-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-08-02T01:48:34.361Z" title="更新于 2024-08-02 09:48:34">2024-08-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%BF%90%E7%BB%B4/">运维</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%BF%90%E7%BB%B4/%EF%BC%88%E4%BA%8C%EF%BC%89%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84/">（二）综合架构</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="综合架构-阿里云进阶-02"><a href="#综合架构-阿里云进阶-02" class="headerlink" title="综合架构-阿里云进阶-02"></a>综合架构-阿里云进阶-02</h1><p>今日内容：</p>
<ul>
<li>CLB&#x2F;ALB负载均衡</li>
<li>域名和DNS配置</li>
<li>HTTPS证书配置</li>
</ul>
<h1 id="一、CLB-ALB负载均衡"><a href="#一、CLB-ALB负载均衡" class="headerlink" title="一、CLB&#x2F;ALB负载均衡"></a>一、CLB&#x2F;ALB负载均衡</h1><p>公有云的负载均衡一般都是现成的产品，一般不需要我们关注产品的底层实现</p>
<h2 id="1-1-CLB和ALB概述"><a href="#1-1-CLB和ALB概述" class="headerlink" title="1.1 CLB和ALB概述"></a>1.1 CLB和ALB概述</h2><p>负载均衡选型：</p>
<ul>
<li>现成产品：<ul>
<li>CLB：传统型负载均衡，以前叫SLB</li>
<li>ALB</li>
</ul>
</li>
<li>也可以自己搭建：ECS * 2 + keepalived，需要提供VIP（原来叫havip）</li>
</ul>
<p>CLB 对比 ALB</p>
<p><img src="/../../../img/image-20240601115122209.png" alt="image-20240601115122209"></p>
<p>CLB和ALB的架构图：</p>
<p><img src="/../../../img/image-20240601134239238.png" alt="image-20240601134239238"></p>
<h2 id="1-2-CLB"><a href="#1-2-CLB" class="headerlink" title="1.2 CLB"></a>1.2 CLB</h2><h3 id="1-2-1-CLB的工作原理"><a href="#1-2-1-CLB的工作原理" class="headerlink" title="1.2.1 CLB的工作原理"></a>1.2.1 CLB的工作原理</h3><p>高清：<a target="_blank" rel="noopener" href="https://www.processon.com/view/link/5eea0f6d07912929cb4a5dab">https://www.processon.com/view/link/5eea0f6d07912929cb4a5dab</a>  </p>
<p>CLB背后的实现架构：</p>
<p><img src="/../../../img/image-20240601134630083.png" alt="image-20240601134630083"></p>
<p>四层和七层的转发</p>
<p><img src="/../../../img/image-20240601134639193.png" alt="image-20240601134639193"></p>
<h3 id="1-2-2-CLB快速上手"><a href="#1-2-2-CLB快速上手" class="headerlink" title="1.2.2 CLB快速上手"></a>1.2.2 CLB快速上手</h3><h4 id="1-2-1-1-环境准备"><a href="#1-2-1-1-环境准备" class="headerlink" title="1.2.1.1 环境准备"></a>1.2.1.1 环境准备</h4><p>准备两台ECS</p>
<table>
<thead>
<tr>
<th>主机名</th>
<th>nginx 1.20</th>
</tr>
</thead>
<tbody><tr>
<td>ecs01</td>
<td>&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;index.html内容ecs001</td>
</tr>
<tr>
<td>ecs02</td>
<td>&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;index.html内容ecs002</td>
</tr>
</tbody></table>
<p>用抢占式的就可以，哪个便宜用哪个。</p>
<p><img src="/../../../img/image-20240601120357751.png" alt="image-20240601120357751"></p>
<p>设置网络和安全组</p>
<p><img src="/../../../img/image-20240601120707329.png" alt="image-20240601120707329"></p>
<p>登录凭证、实例名设置</p>
<blockquote>
<p>如果选了使用密钥对，则账户密码登录会默认关闭</p>
</blockquote>
<p><img src="/../../../img/image-20240601120942455.png" alt="image-20240601120942455"></p>
<p>确认配置</p>
<p><img src="/../../../img/image-20240601121054608.png" alt="image-20240601121054608"></p>
<p>两台ECS都登录，并安装nginx，设置nginx的首页，用于区分</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装nginx</span></span><br><span class="line">yum install -y nginx</span><br><span class="line">systemctl enable --now nginx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">配置站点页面</span></span><br><span class="line">echo aliyun.test.cn `hostname` &gt; /usr/share/nginx/html/index.html</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">测试</span></span><br><span class="line">curl localhost</span><br></pre></td></tr></table></figure>

<h4 id="1-2-1-2-使用CLB"><a href="#1-2-1-2-使用CLB" class="headerlink" title="1.2.1.2 使用CLB"></a>1.2.1.2 使用CLB</h4><h5 id="A）创建CLB"><a href="#A）创建CLB" class="headerlink" title="A）创建CLB"></a>A）创建CLB</h5><p>阿里云控制台，创建</p>
<p><img src="/../../../img/image-20240601121715975.png" alt="image-20240601121715975"></p>
<p>按需求配置</p>
<p><img src="/../../../img/image-20240601122442911.png" alt="image-20240601122442911"></p>
<p><img src="/../../../img/image-20240601122538928.png" alt="image-20240601122538928"></p>
<h5 id="B）监听配置向导"><a href="#B）监听配置向导" class="headerlink" title="B）监听配置向导"></a>B）监听配置向导</h5><p>详情页进入</p>
<p><img src="/../../../img/image-20240601122745243.png" alt="image-20240601122745243"></p>
<p>选择监听协议、端口、设置监听名称</p>
<p><img src="/../../../img/image-20240601122917230.png" alt="image-20240601122917230"></p>
<p>添加后端服务器</p>
<ul>
<li>如果只有一个upstream，用默认服务器组，有多个则用虚拟服务器组</li>
</ul>
<p><img src="/../../../img/image-20240601123037746.png" alt="image-20240601123037746"></p>
<p>添加完，设置端口</p>
<p><img src="/../../../img/image-20240601123133098.png" alt="image-20240601123133098"></p>
<p>健康检查，默认即可，做个简单检查探测</p>
<p><img src="/../../../img/image-20240601123317602.png" alt="image-20240601123317602"></p>
<p>提示缺少nc，在ECS上安装即可，安装完再探测OK</p>
<p><img src="/../../../img/image-20240601123349737.png" alt="image-20240601123349737"></p>
<h5 id="C）测试"><a href="#C）测试" class="headerlink" title="C）测试"></a>C）测试</h5><p>测试访问CLB的公网IP，负载均衡生效</p>
<p><img src="/../../../img/image-20240601123545977.png" alt="image-20240601123545977"></p>
<h3 id="1-2-3-CLB案例-实现动静分离"><a href="#1-2-3-CLB案例-实现动静分离" class="headerlink" title="1.2.3 CLB案例-实现动静分离"></a>1.2.3 CLB案例-实现动静分离</h3><p>架构</p>
<p><img src="/../../../img/image-20240601133035545.png" alt="image-20240601133035545"></p>
<p>根据uri进行转发</p>
<table>
<thead>
<tr>
<th>访问的资源</th>
<th>访问案例</th>
<th>那个节点处理</th>
</tr>
</thead>
<tbody><tr>
<td>静态</td>
<td>&#x2F;static&#x2F;</td>
<td>ecs01（设置为虚拟服务器）</td>
</tr>
<tr>
<td>动态（默认）</td>
<td>其他所有</td>
<td>ecs02（设置为默认服务器）</td>
</tr>
</tbody></table>
<h4 id="A-环境准备"><a href="#A-环境准备" class="headerlink" title="A) 环境准备"></a>A) 环境准备</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ecs01配置</span></span><br><span class="line"></span><br><span class="line">mkdir -p /usr/share/nginx/html/static/</span><br><span class="line">cd /usr/share/nginx/html/static/</span><br><span class="line">echo oldboy css static |tee css&#123;01..10&#125;.css</span><br><span class="line">echo oldboy js static |tee js&#123;01..10&#125;.js</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ecs02配置</span></span><br><span class="line">cd /usr/share/nginx/html/</span><br><span class="line">echo oldboy html default |tee oldboy&#123;01..10&#125;.html</span><br></pre></td></tr></table></figure>

<h4 id="B-配置CLB转发规则"><a href="#B-配置CLB转发规则" class="headerlink" title="B) 配置CLB转发规则"></a>B) 配置CLB转发规则</h4><p>CLB配置，默认服务器组，删除ECS01，只保留02</p>
<p><img src="/../../../img/image-20240601124310325.png" alt="image-20240601124310325"></p>
<p>删除后</p>
<p><img src="/../../../img/image-20240601124328606.png" alt="image-20240601124328606"></p>
<p>创建虚拟服务器组</p>
<p><img src="/../../../img/image-20240601124358844.png" alt="image-20240601124358844"></p>
<p>添加ECS01为虚拟服务器</p>
<p><img src="/../../../img/image-20240601124447016.png" alt="image-20240601124447016"></p>
<p>配置端口80和权重</p>
<p><img src="/../../../img/image-20240601124522380.png" alt="image-20240601124522380"></p>
<p>切换到监听标签，配置转发规则</p>
<p><img src="/../../../img/image-20240601124639627.png" alt="image-20240601124639627"></p>
<p>设置URL，这里注意<code>/static/</code>跟<code>/static</code>是不同的，要分清</p>
<p><img src="/../../../img/image-20240601124812171.png" alt="image-20240601124812171"></p>
<h4 id="C-测试"><a href="#C-测试" class="headerlink" title="C) 测试"></a>C) 测试</h4><p>在windows用curl测试连接</p>
<p><img src="/../../../img/image-20240601125128639.png" alt="image-20240601125128639"></p>
<p>但这样怎么知道，到底是走的ECS01还是02？有两种方法可以判断</p>
<ol>
<li>抓包</li>
<li>查看nginx访问日志（用这个）</li>
</ol>
<p><img src="/../../../img/image-20240601125536286.png" alt="image-20240601125536286"></p>
<h4 id="D-报错403分析"><a href="#D-报错403分析" class="headerlink" title="D) 报错403分析"></a>D) 报错403分析</h4><p>在1.4.3测试中，如果只访问到<code>/static/</code>目录，会报403的错误</p>
<p>一般两种原因：</p>
<ul>
<li>权限过低</li>
<li>首页文件不存在（是这个引起）</li>
</ul>
<p>因此也并不算问题，确实没有<code>index.html</code>文件</p>
<p><img src="/../../../img/image-20240601125718830.png" alt="image-20240601125718830"></p>
<h3 id="1-2-4-CLB小结"><a href="#1-2-4-CLB小结" class="headerlink" title="1.2.4 CLB小结"></a>1.2.4 CLB小结</h3><p>CLB，原SLB，负责7层和4层的负载均衡</p>
<ul>
<li>7层功能更只限对于域名转发和uri的转发（location规则）</li>
<li>如果是更加复杂的转发，需要自己搭建负载均衡，或者使用ALB</li>
</ul>
<h2 id="1-3-ALB负载均衡"><a href="#1-3-ALB负载均衡" class="headerlink" title="1.3 ALB负载均衡"></a>1.3 ALB负载均衡</h2><p>ALB全称应用负载均衡，是对传统负载均衡（CLB）在7层功能上的扩展与加强</p>
<p>ALB只能用于7层</p>
<p><img src="/../../../img/image-20240601134908159.png" alt="image-20240601134908159"></p>
<h3 id="1-3-1-案例01-根据户端类型转发"><a href="#1-3-1-案例01-根据户端类型转发" class="headerlink" title="1.3.1 案例01-根据户端类型转发"></a>1.3.1 案例01-根据户端类型转发</h3><table>
<thead>
<tr>
<th>客户端类型</th>
<th>转发</th>
<th>节点</th>
</tr>
</thead>
<tbody><tr>
<td>Chrome</td>
<td>转发到PC</td>
<td>ECS01</td>
</tr>
<tr>
<td>Android</td>
<td>转发到移动端</td>
<td>ECS02</td>
</tr>
</tbody></table>
<p>实现原理，类似于在Nginx中做了设置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if ( $http_user_agent ~* &quot;Chrome&quot; ) &#123;</span><br><span class="line">	proxy_pass http://pc;</span><br><span class="line">&#125;</span><br><span class="line">if ( $http_user_agent ~* &quot;Android&quot; ) &#123;</span><br><span class="line">	proxy_pass http://mobile;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="A）准备两台ECS"><a href="#A）准备两台ECS" class="headerlink" title="A）准备两台ECS"></a>A）准备两台ECS</h4><p>配置站点文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ecs01</span></span><br><span class="line">echo pc_default &gt;/usr/share/nginx/html/index.html</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ecs02</span></span><br><span class="line">echo mobile &gt;/usr/share/nginx/html/index.html</span><br></pre></td></tr></table></figure>

<h4 id="B）准备ALB服务器"><a href="#B）准备ALB服务器" class="headerlink" title="B）准备ALB服务器"></a>B）准备ALB服务器</h4><p>点击创建</p>
<p><img src="/../../../img/image-20240603145330743.png" alt="image-20240603145330743">地域选择</p>
<p><img src="/../../../img/image-20240603145400789.png" alt="image-20240603145400789"></p>
<p>网络配置</p>
<p><img src="/../../../img/image-20240603145431531.png" alt="image-20240603145431531"></p>
<p>创建关联角色</p>
<p><img src="/../../../img/image-20240603145514928.png" alt="image-20240603145514928"></p>
<p>创建完可以看到ALB的域名</p>
<p><img src="/../../../img/image-20240603145548928.png" alt="image-20240603145548928"></p>
<h4 id="C）创建后端服务器组"><a href="#C）创建后端服务器组" class="headerlink" title="C）创建后端服务器组"></a>C）创建后端服务器组</h4><p>进入ALB详情页，点击创建</p>
<p><img src="/../../../img/image-20240603145734145.png" alt="image-20240603145734145"></p>
<p>填写信息，创建一个”PC端”的</p>
<p><img src="/../../../img/image-20240603145802860.png" alt="image-20240603145802860"></p>
<p>再创建一个“移动端”的</p>
<p><img src="/../../../img/image-20240603145849154.png" alt="image-20240603145849154"></p>
<p>点“0”进入，编辑后端服务器，添加后端服务器</p>
<p><img src="/../../../img/image-20240603150107692.png" alt="image-20240603150107692"></p>
<p>下一步，加个端口</p>
<p><img src="/../../../img/image-20240603150130883.png" alt="image-20240603150130883"></p>
<p>另一台，相同操作，添加完有两台后端服务器</p>
<p><img src="/../../../img/image-20240603150227093.png" alt="image-20240603150227093"></p>
<h4 id="D）创建监听"><a href="#D）创建监听" class="headerlink" title="D）创建监听"></a>D）创建监听</h4><p>实例详情页，创建监听</p>
<p><img src="/../../../img/image-20240603150306430.png" alt="image-20240603150306430"></p>
<p>配置监听</p>
<p><img src="/../../../img/image-20240603150331581.png" alt="image-20240603150331581"></p>
<p>选择服务器组</p>
<p><img src="/../../../img/image-20240603150356184.png" alt="image-20240603150356184"></p>
<p>提交</p>
<p><img src="/../../../img/image-20240603150418227.png" alt="image-20240603150418227"></p>
<h4 id="E）配置Location规则"><a href="#E）配置Location规则" class="headerlink" title="E）配置Location规则"></a>E）配置Location规则</h4><p>编辑转发规则</p>
<p><img src="/../../../img/image-20240603150448410.png" alt="image-20240603150448410"></p>
<p>插入新规则</p>
<p><img src="/../../../img/image-20240603150712023.png" alt="image-20240603150712023"></p>
<p>填写信息，“移动端”转发</p>
<p><img src="/../../../img/image-20240603150747887.png" alt="image-20240603150747887"></p>
<h4 id="F）测试"><a href="#F）测试" class="headerlink" title="F）测试"></a>F）测试</h4><p><img src="/../../../img/image-20240603151031560.png" alt="image-20240603151031560"></p>
<h3 id="1-3-2-ALB小结"><a href="#1-3-2-ALB小结" class="headerlink" title="1.3.2 ALB小结"></a>1.3.2 ALB小结</h3><p>ALB应用场景：</p>
<ul>
<li>流量镜像<ul>
<li>用户访问的流量过来，复制一份</li>
<li>一份正常处理，另一份镜像用于其他功能（测试、分析…）</li>
</ul>
</li>
<li>根据域名&#x2F;uri&#x2F; 请求&#x2F;响应报头进行转发 (客户端浏览器,语言)</li>
<li>其他..</li>
</ul>
<p><img src="/../../../img/image-20240603151407856.png" alt="image-20240603151407856"></p>
<h1 id="二、域名和DNS"><a href="#二、域名和DNS" class="headerlink" title="二、域名和DNS"></a>二、域名和DNS</h1><h2 id="2-1-DNS云解析"><a href="#2-1-DNS云解析" class="headerlink" title="2.1 DNS云解析"></a>2.1 DNS云解析</h2><h3 id="2-1-1-DNS记录类型"><a href="#2-1-1-DNS记录类型" class="headerlink" title="2.1.1 DNS记录类型"></a>2.1.1 DNS记录类型</h3><p>DNS如何对应ip地址或其他内容</p>
<table>
<thead>
<tr>
<th>记录类型</th>
<th>作用</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>A记录</td>
<td>IPV4解析</td>
<td><a target="_blank" rel="noopener" href="http://www.test.com/">www.test.com</a> — 10.67.32.11</td>
</tr>
<tr>
<td>AAAA记录</td>
<td>IPV6解析</td>
<td></td>
</tr>
<tr>
<td>CNAME记录</td>
<td>别名记录（CDN常用）</td>
<td><a target="_blank" rel="noopener" href="http://www.test.com/">www.test.com</a> —- <a target="_blank" rel="noopener" href="http://www.cdn.test.com/">www.cdn.test.com</a></td>
</tr>
<tr>
<td>MX记录</td>
<td>配置邮箱、企业邮箱</td>
<td></td>
</tr>
<tr>
<td>TXT记录</td>
<td>文本（常用于记录域名所有者）</td>
<td>Author haris</td>
</tr>
</tbody></table>
<h3 id="2-1-2-配置云解析"><a href="#2-1-2-配置云解析" class="headerlink" title="2.1.2 配置云解析"></a>2.1.2 配置云解析</h3><p>首页进入</p>
<p><img src="/../../../img/image-20240603153559971.png" alt="image-20240603153559971"></p>
<p>进入“解析设置”</p>
<p><img src="/../../../img/image-20240603153622347.png" alt="image-20240603153622347"></p>
<p>添加“A记录”</p>
<p><img src="/../../../img/image-20240603153832000.png" alt="image-20240603153832000"></p>
<p>再添加一条“TXT记录”</p>
<p><img src="/../../../img/image-20240603153957387.png" alt="image-20240603153957387"></p>
<p>测试访问</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用dig命令</span></span><br><span class="line">dig txt check.oldboylinux.cn</span><br></pre></td></tr></table></figure>

<p><img src="/../../../img/image-20240603154040194.png" alt="image-20240603154040194"></p>
<h3 id="2-1-3-域名小结"><a href="#2-1-3-域名小结" class="headerlink" title="2.1.3 域名小结"></a>2.1.3 域名小结</h3><p>最常用的DNS记录类型:</p>
<ul>
<li>A记录,最常用的记录之一.域名—-ip</li>
<li>CNAME记录,别名记录,一般用于CDN.</li>
<li>TXT记录,域名—字符串,一般用于域名验证.</li>
<li>MX记录,一般用于配置企业邮箱,跟随配置要求进行设置即可.</li>
</ul>
<p>DNS术语: 记录类型,主机记录,ttl(Time To Live 缓存,生效)   </p>
<h1 id="三、HTTPS证书"><a href="#三、HTTPS证书" class="headerlink" title="三、HTTPS证书"></a>三、HTTPS证书</h1><h2 id="3-1-申请证书"><a href="#3-1-申请证书" class="headerlink" title="3.1 申请证书"></a>3.1 申请证书</h2><p>页面点击</p>
<p><img src="/../../../img/image-20240603154420818.png" alt="image-20240603154420818"></p>
<p>填写信息</p>
<p><img src="/../../../img/image-20240603154436704.png" alt="image-20240603154436704"></p>
<p>查看已签发的证书</p>
<p><img src="/../../../img/image-20240603154458220.png" alt="image-20240603154458220"></p>
<h2 id="3-2-证书使用案例"><a href="#3-2-证书使用案例" class="headerlink" title="3.2 证书使用案例"></a>3.2 证书使用案例</h2><h3 id="3-2-1-案例01-负载均衡绑定证书"><a href="#3-2-1-案例01-负载均衡绑定证书" class="headerlink" title="3.2.1 案例01-负载均衡绑定证书"></a>3.2.1 案例01-负载均衡绑定证书</h3><p><img src="/../../../img/image-20240603154533096.png" alt="image-20240603154533096"></p>
<h3 id="3-2-2-案例02-HTTP升级HTTPS"><a href="#3-2-2-案例02-HTTP升级HTTPS" class="headerlink" title="3.2.2 案例02-HTTP升级HTTPS"></a>3.2.2 案例02-HTTP升级HTTPS</h3><p>负载均衡设置“监听转发”</p>
<p><img src="/../../../img/image-20240603154644992.png" alt="image-20240603154644992"></p>
<p>添加完之后，可以看到多了一个443的监听</p>
<p><img src="/../../../img/image-20240603154720293.png" alt="image-20240603154720293"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://gsproj.github.io">Haris</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://gsproj.github.io/2024/05/31/07_85%E6%9C%9F%E8%BF%90%E7%BB%B4/03_%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%B6%E6%9E%84/day65-%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84-%E9%98%BF%E9%87%8C%E4%BA%91%E8%BF%9B%E9%98%B6-2/">http://gsproj.github.io/2024/05/31/07_85%E6%9C%9F%E8%BF%90%E7%BB%B4/03_%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%B6%E6%9E%84/day65-%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84-%E9%98%BF%E9%87%8C%E4%BA%91%E8%BF%9B%E9%98%B6-2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://gsproj.github.io" target="_blank">迎风之豚的博客</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/%E7%BA%A2%E7%8C%AA.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/05/31/07_85%E6%9C%9F%E8%BF%90%E7%BB%B4/03_%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%B6%E6%9E%84/day64-%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84-%E9%98%BF%E9%87%8C%E4%BA%91%E8%BF%9B%E9%98%B6-1/" title="day64-综合架构-阿里云进阶（一）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">day64-综合架构-阿里云进阶（一）</div></div><div class="info-2"><div class="info-item-1">综合架构-阿里云进阶-01今日内容：  公有云架构介绍 ECS弹性服务器使用 RDS数据库服务器使用 NAS文件存储使用 OSS对象存储使用  一、公有云目标要求：  能熟练的说出或识别公有云服务名字 能熟练说出和画出公有云网站架构 能熟练使用公有云的产品，比如：ecs、slb、rds、oss…. 熟悉服务购买、续费操作  二、公有云架构用户角度：  运维角度： 一些专业词汇    专业词汇     ecs 云服务器   vpc 虚拟专用网络 局域网   安全组 防火墙,白名单   实例 阿里云中任何一个产品或一个功能, 每个实例一般有一个独一无二的id.   1c1g 2c4g 云服务器的配置   快照 类似于虚拟机的快照, 快照默认按量收费 (购买存储包 包年包月)   镜像 创建镜像,需要创建快照—-&gt;镜像 , 镜像可以用来实现克隆的功能. 网站迁移功能   云盘 云服务器的磁盘 系统盘 数据盘   eip 弹性公网ip, 主要可以给slb,ecs….   按量负载(后付费)    包年包月(预付费)    三、ECS弹性服务器3.1...</div></div></div></a><a class="pagination-related" href="/2024/05/31/07_85%E6%9C%9F%E8%BF%90%E7%BB%B4/03_%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%B6%E6%9E%84/day66-%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84-%E9%98%BF%E9%87%8C%E4%BA%91%E8%BF%9B%E9%98%B6-3/" title="day66-综合架构-阿里云进阶（三）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">day66-综合架构-阿里云进阶（三）</div></div><div class="info-2"><div class="info-item-1">综合架构-阿里云进阶-03今日内容：  CDN 阿里云NAT配置 阿里云安全管理  一、CDN1.1 CDN概述CDN的作用：  为网站进行加速 一般用于缓存静态资源: html,css,js,图片,视频.  实现的原理：  将网站内容缓存到CDN服务商的服务器中 缓存是分布式缓存，全国各地都有 根据用户距离，就近提供数据，实现加速访问  CDN厂商：  阿里云&#x2F;腾讯云 蓝汛 网宿 GoDaddy Cloudflare  1.2 CDN流程分析没使用CDN  用户向DNS服务器请求IP 远端服务返回给用户 存在速度慢、服务器挂了等问题   用户拿着IP向WEB服务器请求网站数据 存在速度慢、服务器挂了等问题     使用CDN后  用户向DNS服务器请求IP CDN就近发送IP给用户   用户拿着IP向CDN要网站数据 如果有，立即返回 如果没有，反向代理，CDN从源服务器获取数据，再返回给用户     1.3 配置CDN1.3.1 配置流程开通CDN服务  添加加速域名  获取域名对应的cname链接  cdn cname 配置完成, 对cdn进行刷新预热...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/%E7%BA%A2%E7%8C%AA.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Haris</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">208</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">29</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%BC%E5%90%88%E6%9E%B6%E6%9E%84-%E9%98%BF%E9%87%8C%E4%BA%91%E8%BF%9B%E9%98%B6-02"><span class="toc-number">1.</span> <span class="toc-text">综合架构-阿里云进阶-02</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81CLB-ALB%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="toc-number">2.</span> <span class="toc-text">一、CLB&#x2F;ALB负载均衡</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-CLB%E5%92%8CALB%E6%A6%82%E8%BF%B0"><span class="toc-number">2.1.</span> <span class="toc-text">1.1 CLB和ALB概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-CLB"><span class="toc-number">2.2.</span> <span class="toc-text">1.2 CLB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-1-CLB%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">2.2.1.</span> <span class="toc-text">1.2.1 CLB的工作原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-2-CLB%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B"><span class="toc-number">2.2.2.</span> <span class="toc-text">1.2.2 CLB快速上手</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-1-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">1.2.1.1 环境准备</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-2-%E4%BD%BF%E7%94%A8CLB"><span class="toc-number">2.2.2.2.</span> <span class="toc-text">1.2.1.2 使用CLB</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#A%EF%BC%89%E5%88%9B%E5%BB%BACLB"><span class="toc-number">2.2.2.2.1.</span> <span class="toc-text">A）创建CLB</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#B%EF%BC%89%E7%9B%91%E5%90%AC%E9%85%8D%E7%BD%AE%E5%90%91%E5%AF%BC"><span class="toc-number">2.2.2.2.2.</span> <span class="toc-text">B）监听配置向导</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#C%EF%BC%89%E6%B5%8B%E8%AF%95"><span class="toc-number">2.2.2.2.3.</span> <span class="toc-text">C）测试</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-3-CLB%E6%A1%88%E4%BE%8B-%E5%AE%9E%E7%8E%B0%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB"><span class="toc-number">2.2.3.</span> <span class="toc-text">1.2.3 CLB案例-实现动静分离</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#A-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">2.2.3.1.</span> <span class="toc-text">A) 环境准备</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#B-%E9%85%8D%E7%BD%AECLB%E8%BD%AC%E5%8F%91%E8%A7%84%E5%88%99"><span class="toc-number">2.2.3.2.</span> <span class="toc-text">B) 配置CLB转发规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#C-%E6%B5%8B%E8%AF%95"><span class="toc-number">2.2.3.3.</span> <span class="toc-text">C) 测试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#D-%E6%8A%A5%E9%94%99403%E5%88%86%E6%9E%90"><span class="toc-number">2.2.3.4.</span> <span class="toc-text">D) 报错403分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-4-CLB%E5%B0%8F%E7%BB%93"><span class="toc-number">2.2.4.</span> <span class="toc-text">1.2.4 CLB小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-ALB%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="toc-number">2.3.</span> <span class="toc-text">1.3 ALB负载均衡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-1-%E6%A1%88%E4%BE%8B01-%E6%A0%B9%E6%8D%AE%E6%88%B7%E7%AB%AF%E7%B1%BB%E5%9E%8B%E8%BD%AC%E5%8F%91"><span class="toc-number">2.3.1.</span> <span class="toc-text">1.3.1 案例01-根据户端类型转发</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#A%EF%BC%89%E5%87%86%E5%A4%87%E4%B8%A4%E5%8F%B0ECS"><span class="toc-number">2.3.1.1.</span> <span class="toc-text">A）准备两台ECS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#B%EF%BC%89%E5%87%86%E5%A4%87ALB%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">2.3.1.2.</span> <span class="toc-text">B）准备ALB服务器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#C%EF%BC%89%E5%88%9B%E5%BB%BA%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BB%84"><span class="toc-number">2.3.1.3.</span> <span class="toc-text">C）创建后端服务器组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#D%EF%BC%89%E5%88%9B%E5%BB%BA%E7%9B%91%E5%90%AC"><span class="toc-number">2.3.1.4.</span> <span class="toc-text">D）创建监听</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#E%EF%BC%89%E9%85%8D%E7%BD%AELocation%E8%A7%84%E5%88%99"><span class="toc-number">2.3.1.5.</span> <span class="toc-text">E）配置Location规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#F%EF%BC%89%E6%B5%8B%E8%AF%95"><span class="toc-number">2.3.1.6.</span> <span class="toc-text">F）测试</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-2-ALB%E5%B0%8F%E7%BB%93"><span class="toc-number">2.3.2.</span> <span class="toc-text">1.3.2 ALB小结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%9F%9F%E5%90%8D%E5%92%8CDNS"><span class="toc-number">3.</span> <span class="toc-text">二、域名和DNS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-DNS%E4%BA%91%E8%A7%A3%E6%9E%90"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 DNS云解析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-1-DNS%E8%AE%B0%E5%BD%95%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.1.1.</span> <span class="toc-text">2.1.1 DNS记录类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-2-%E9%85%8D%E7%BD%AE%E4%BA%91%E8%A7%A3%E6%9E%90"><span class="toc-number">3.1.2.</span> <span class="toc-text">2.1.2 配置云解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-3-%E5%9F%9F%E5%90%8D%E5%B0%8F%E7%BB%93"><span class="toc-number">3.1.3.</span> <span class="toc-text">2.1.3 域名小结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81HTTPS%E8%AF%81%E4%B9%A6"><span class="toc-number">4.</span> <span class="toc-text">三、HTTPS证书</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E7%94%B3%E8%AF%B7%E8%AF%81%E4%B9%A6"><span class="toc-number">4.1.</span> <span class="toc-text">3.1 申请证书</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E8%AF%81%E4%B9%A6%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">4.2.</span> <span class="toc-text">3.2 证书使用案例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-%E6%A1%88%E4%BE%8B01-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%BB%91%E5%AE%9A%E8%AF%81%E4%B9%A6"><span class="toc-number">4.2.1.</span> <span class="toc-text">3.2.1 案例01-负载均衡绑定证书</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-%E6%A1%88%E4%BE%8B02-HTTP%E5%8D%87%E7%BA%A7HTTPS"><span class="toc-number">4.2.2.</span> <span class="toc-text">3.2.2 案例02-HTTP升级HTTPS</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/12/09_%E9%9F%A9%E5%85%88%E8%B6%85K8S/01-Docker%E5%9F%BA%E7%A1%80/04-Dockerfile%E5%AE%9E%E6%88%98%E7%AF%87-%E6%9E%84%E5%BB%BA%E4%BC%81%E4%B8%9A%E7%BA%A7%E9%95%9C%E5%83%8F/" title="04-Dockerfile实战篇-构建企业级镜像">04-Dockerfile实战篇-构建企业级镜像</a><time datetime="2025-03-12T07:12:52.000Z" title="发表于 2025-03-12 15:12:52">2025-03-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/04/09_%E9%9F%A9%E5%85%88%E8%B6%85K8S/01-Docker%E5%9F%BA%E7%A1%80/03-Dockerfile%E5%9F%BA%E7%A1%80%E7%AF%87-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/" title="03-Dockerfile基础篇-基本语法">03-Dockerfile基础篇-基本语法</a><time datetime="2025-03-04T07:12:52.000Z" title="发表于 2025-03-04 15:12:52">2025-03-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/03/09_%E9%9F%A9%E5%85%88%E8%B6%85K8S/01-Docker%E5%9F%BA%E7%A1%80/02-%E8%BF%90%E8%A1%8CDocker%E5%AE%B9%E5%99%A8/" title="02-运行Docker容器">02-运行Docker容器</a><time datetime="2025-03-03T07:12:52.000Z" title="发表于 2025-03-03 15:12:52">2025-03-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/03/09_%E9%9F%A9%E5%85%88%E8%B6%85K8S/01-Docker%E5%9F%BA%E7%A1%80/01-Dokcer%E5%AE%B9%E5%99%A8%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/" title="01-Docker基础">01-Docker基础</a><time datetime="2025-03-03T04:30:52.000Z" title="发表于 2025-03-03 12:30:52">2025-03-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/25/06_%E6%9D%82%E8%AE%B0/Ubuntu22.04%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A/" title="Ubuntu22.04显卡直通虚拟机">Ubuntu22.04显卡直通虚拟机</a><time datetime="2025-02-25T09:50:52.000Z" title="发表于 2025-02-25 17:50:52">2025-02-25</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/footer.png);"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By Haris</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>