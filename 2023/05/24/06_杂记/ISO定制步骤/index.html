<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>母盘ISO定制步骤 | Haris的小站</title><meta name="author" content="Haris"><meta name="copyright" content="Haris"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="母盘ISO定制步骤一、环境准备1.1 镜像文件和操作系统ISO修改环境的操作系统和需要定制修改的操作系统ISO镜像： Kylin-Desktop-V10-SP1-General-Release-2203-ARM64.iso 进入操作系统，操作以下命令 12345678910111213141516171819202122# 切换到root用户sudo su # 安装必要软件sudo apt-get">
<meta property="og:type" content="article">
<meta property="og:title" content="母盘ISO定制步骤">
<meta property="og:url" content="http://gsproj.github.io/2023/05/24/06_%E6%9D%82%E8%AE%B0/ISO%E5%AE%9A%E5%88%B6%E6%AD%A5%E9%AA%A4/index.html">
<meta property="og:site_name" content="Haris的小站">
<meta property="og:description" content="母盘ISO定制步骤一、环境准备1.1 镜像文件和操作系统ISO修改环境的操作系统和需要定制修改的操作系统ISO镜像： Kylin-Desktop-V10-SP1-General-Release-2203-ARM64.iso 进入操作系统，操作以下命令 12345678910111213141516171819202122# 切换到root用户sudo su # 安装必要软件sudo apt-get">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://gsproj.github.io/img/%E5%A4%B4%E5%83%8F.png">
<meta property="article:published_time" content="2023-05-24T02:10:52.000Z">
<meta property="article:modified_time" content="2024-08-02T01:48:34.361Z">
<meta property="article:author" content="Haris">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://gsproj.github.io/img/%E5%A4%B4%E5%83%8F.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "母盘ISO定制步骤",
  "url": "http://gsproj.github.io/2023/05/24/06_%E6%9D%82%E8%AE%B0/ISO%E5%AE%9A%E5%88%B6%E6%AD%A5%E9%AA%A4/",
  "image": "http://gsproj.github.io/img/%E5%A4%B4%E5%83%8F.png",
  "datePublished": "2023-05-24T02:10:52.000Z",
  "dateModified": "2024-08-02T01:48:34.361Z",
  "author": [
    {
      "@type": "Person",
      "name": "Haris",
      "url": "http://gsproj.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://gsproj.github.io/2023/05/24/06_%E6%9D%82%E8%AE%B0/ISO%E5%AE%9A%E5%88%B6%E6%AD%A5%E9%AA%A4/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '母盘ISO定制步骤',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/modify.css"><style>#article-container.post-content h1:before, h2:before, h3:before, h4:before, h5:before, h6:before { -webkit-animation: avatar_turn_around 1s linear infinite; -moz-animation: avatar_turn_around 1s linear infinite; -o-animation: avatar_turn_around 1s linear infinite; -ms-animation: avatar_turn_around 1s linear infinite; animation: avatar_turn_around 1s linear infinite; }</style><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="/css/loading-bar.css"><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg" style="background-image: url(/img/猫.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/%E5%A4%B4%E5%83%8F.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">215</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">32</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/car2.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Haris的小站</span></a><a class="nav-page-title" href="/"><span class="site-name">母盘ISO定制步骤</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">母盘ISO定制步骤</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-05-24T02:10:52.000Z" title="发表于 2023-05-24 10:10:52">2023-05-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-08-02T01:48:34.361Z" title="更新于 2024-08-02 09:48:34">2024-08-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%9D%82%E8%AE%B0/">杂记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><div class="top-img" style="background-image: url(/img/car2.png);"></div><article class="container post-content" id="article-container"><h1 id="母盘ISO定制步骤"><a href="#母盘ISO定制步骤" class="headerlink" title="母盘ISO定制步骤"></a>母盘ISO定制步骤</h1><h1 id="一、环境准备"><a href="#一、环境准备" class="headerlink" title="一、环境准备"></a>一、环境准备</h1><h2 id="1-1-镜像文件和操作系统"><a href="#1-1-镜像文件和操作系统" class="headerlink" title="1.1 镜像文件和操作系统"></a>1.1 镜像文件和操作系统</h2><p>ISO修改环境的操作系统和需要定制修改的操作系统ISO镜像：</p>
<p><strong>Kylin-Desktop-V10-SP1-General-Release-2203-ARM64.iso</strong></p>
<p>进入操作系统，操作以下命令</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">切换到root用户</span></span><br><span class="line">sudo su </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装必要软件</span></span><br><span class="line">sudo apt-get install squashfs-tools genisoimage</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">切换到/opt目录，创建四个文件夹</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/opt/mnt - 挂载镜像文件</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/opt/livecd - 镜像文件内容拷贝，用于最后打包成新镜像</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/opt/mylivecd - 镜像文件内容拷贝，用于将软件、补丁集成到镜像中，生成filesystem.squashfs等文件</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/opt/tool - 用于存放镜像ISO等文件</span></span><br><span class="line">cd /opt	&amp;&amp; mkdir mnt livecd tool mylivecd </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">挂载需要修改的镜像文件，到/opt/mnt</span></span><br><span class="line">mount -o loop /opt/tool/Kylin-Desktop-V10-SP1-General-Release-2203-ARM64.iso  /opt/mnt/</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将镜像内的文件拷贝出来</span></span><br><span class="line">rsync -av /opt/mnt/ /opt/livecd/	</span><br><span class="line">rsync -av /opt/mnt/ /opt/mylivecd/	</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">取消挂载ISO镜像</span></span><br><span class="line">umount /opt/mnt/</span><br></pre></td></tr></tbody></table></figure>

<h1 id="二、修改镜像文件"><a href="#二、修改镜像文件" class="headerlink" title="二、修改镜像文件"></a>二、修改镜像文件</h1><p>先执行以下命令：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">切换到mylivecd目录</span></span><br><span class="line">cd /opt/mylivecd/casper/</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">执行unsquashfs命令</span></span><br><span class="line">unsquashfs filesystem.squashfs</span><br></pre></td></tr></tbody></table></figure>

<h2 id="2-1-导入补丁和预装软件包"><a href="#2-1-导入补丁和预装软件包" class="headerlink" title="2.1 导入补丁和预装软件包"></a>2.1 导入补丁和预装软件包</h2><p>安装1107补丁、PKS补丁及预装软件deb包</p>
<p>1、分别创建三个文件夹，并将需要安装的补丁、软件拷贝到三个文件夹中</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/livecd &amp;&amp; mkdir 1107 option pks </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/opt/livecd/1107 - 存放1107补丁</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/opt/livecd/pks - 存放PKS补丁</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/opt/livecd/option - 存放定制软件deb包，如数科OFD、金山WPS等</span></span><br></pre></td></tr></tbody></table></figure>

<p>2、修改.kylin-post-actions文件</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /opt/livecd/.kylin-post-actions</span><br></pre></td></tr></tbody></table></figure>

<p>修改后的内容如下：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">rm -rf /etc/apt/apt.conf.d/00recommends</span><br><span class="line">rm -rf /etc/apt/apt.conf.d/00secure</span><br><span class="line">rm -rf /etc/modules-load.d/cups-filters.conf</span><br><span class="line"></span><br><span class="line">cat &gt; /etc/apt/sources.list &lt;&lt;EOF</span><br><span class="line">deb http://archive.kylinos.cn/kylin/KYLIN-ALL 10.1 main restricted universe multiverse</span><br><span class="line">deb http://archive.kylinos.cn/kylin/KYLIN-ALL 10.1-2203-updates main restricted universe multiverse</span><br><span class="line">deb http://archive2.kylinos.cn/deb/kylin/production/PART-V10-SP1/custom/partner/V10-SP1 default all</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">rm -rf /etc/apt/sources.list.d/*</span><br><span class="line">rm -rf /etc/apt/preferences.d/*</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">解决网络安装后不能设置IP bug.</span></span><br><span class="line">mv /opt/interfaces /etc/network/</span><br><span class="line"></span><br><span class="line">mkdir -p /etc/apt/preferences.d/</span><br><span class="line">mkdir -p /etc/apt/sources.list.d/</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#解决xrdp远程桌面ssl文件访问权限问题，后续要查清楚原因，用脚本改感觉有安全漏洞</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#包列表新增xrdp、xorgxrdp,kylin.chroot脚本增加.xsession</span></span></span><br><span class="line">chmod -R a+x /etc/ssl/private</span><br><span class="line">chmod -R a+r /etc/ssl/private</span><br><span class="line">chmod a+r /etc/ssl/private/ssl-cert-snakeoil.key</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">移除社区内核</span></span><br><span class="line">dpkg -P linux-headers-5.4.0-29 linux-headers-5.4.0-29-generic linux-image-5.4.0-29-generic linux-modules-5.4.0-29-generic linux-modules-extra-5.4.0-29-generic</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装奇安信杀毒</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">dpkg -i /opt/QAXS/*.deb</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">rm</span> /opt/QAXS -rf</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sshd 服务异常， 缺少key文件，dpkg-reconfigure openssh-server 能解决问题。</span></span><br><span class="line">dpkg-reconfigure openssh-server</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">第三方包因安装后过大，后置安装</span></span><br><span class="line">dpkg -i /opt/third/*.deb</span><br><span class="line">rm /opt/third -rf</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">----制作母盘修改 start----</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1、补丁集安装，后置安装</span></span><br><span class="line">bash /tmp/k-i/1108/other.sh hn123123</span><br><span class="line">rm /tmp/k-i/1107 -rf</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2、pks补丁安装，后置安装</span></span><br><span class="line">sudo dpkg -i /tmp/k-i/pks/libblkid1_2.34-0.1kylin18_arm64.deb &amp;&amp;sudo dpkg -i /tmp/k-i/pks/1/*.deb</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## 1、删除</span></span></span><br><span class="line">sudo mv /etc/resolv.conf /etc/resolv.conf.bak</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## 2、创建软连接</span></span></span><br><span class="line">sudo ln -s /run/systemd/resolve/resolv.conf /etc/resolv.conf</span><br><span class="line">rm /tmp/k-i/pks -rf</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3、第三方包安装</span></span><br><span class="line">dpkg -i /tmp/k-i/option/*.deb</span><br><span class="line">rm /tmp/k-i/option -rf</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">----制作母盘修改 end----</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">（本次dpkg，放在本脚本的最后执行）</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安全默认开启包安装20210604，bjca包在安装时安装20210611</span></span><br><span class="line">dpkg -i /opt/kscset/*.deb</span><br><span class="line">rm /opt/kscset -rf</span><br><span class="line">dpkg -P ksc-set</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">关闭sshd服务</span></span><br><span class="line">systemctl disable sshd</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h2 id="2-2-导入办公桌面"><a href="#2-2-导入办公桌面" class="headerlink" title="2.2  导入办公桌面"></a>2.2  导入办公桌面</h2><p>1、将<strong>办公桌面deb安装包</strong>和<strong>PKS-C1使用指导</strong>拷贝到镜像文件夹</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cp officedesktop_ft2000_kylinv10sp1_cec_0.0.8.91-a20_20230324.run  /opt/mylivecd/casper/squashfs-root/home/</span><br><span class="line"></span><br><span class="line">cp PKS-C1项目用户使用指导.pdf  /opt/mylivecd/casper/squashfs-root/home/</span><br></pre></td></tr></tbody></table></figure>

<p>2、拷贝办公桌面<strong>rc.local</strong>文件到虚拟镜像，用于自动安装办公桌面</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp rc.local  /opt/mylivecd/casper/squashfs-root/etc/ </span><br><span class="line">chmod 755 /opt/mylivecd/casper/squashfs-root/etc/rc.local </span><br></pre></td></tr></tbody></table></figure>

<p>rc.local文件内容如下</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">stat=`getstatus|grep exec|awk -F ' ' '{print $3}'`</span><br><span class="line">if [ "$stat" = "off" ];then</span><br><span class="line">        echo "已经是关闭状态"</span><br><span class="line">else</span><br><span class="line">        setsignstatus off</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">sudo su - root</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="keyword">if</span> [ -f ];<span class="keyword">then</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">      dpkg -i</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">      <span class="built_in">sleep</span> 3</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="keyword">fi</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#办公桌面安装</span></span></span><br><span class="line">if [ -f /home/officedesktop_ft2000_kylinv10sp1_cec_0.0.8.91-a20_20230324.run ] ;then</span><br><span class="line">        chmod +x /home/officedesktop_ft2000_kylinv10sp1_cec_0.0.8.91-a20_20230324.run</span><br><span class="line">        /home/officedesktop_ft2000_kylinv10sp1_cec_0.0.8.91-a20_20230324.run -c -p all -V</span><br><span class="line">        if [ $? -eq 0 ];then</span><br><span class="line">                rm -f /home/officedesktop_ft2000_kylinv10sp1_cec_0.0.8.91-a20_20230324.run</span><br><span class="line">                cp /home/*.pdf /home/greatwall/桌面/</span><br><span class="line">                rm -f /home/*.pdf</span><br><span class="line">                cd  /usr/share/applications/ &amp;&amp; cp qaxbrowser-safe.desktop officedesktop.desktop cn.lanxin.desktop qaxbrowser-safe.desktop wps-office-et.desktop wps-office-official.desktop wps-office-pdf.desktop wps-office-wpp.desktop wps-office-wps.desktop /home/greatwall/桌面/ &amp;&amp; chmod 755 /home/greatwall/桌面/*.desktop</span><br><span class="line">                setsignstatus on</span><br><span class="line">        fi</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if [ -f /etc/rc.local ];then</span><br><span class="line">        at now+5 minutes &lt;&lt;&lt; "find /etc/ -name rc.local -exec rm -rf {} \;"</span><br><span class="line">fi</span><br></pre></td></tr></tbody></table></figure>

<p>3、编辑z.sh文件</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /opt/mylivecd/casper/squashfs-root/usr/share/kylin-os-installer/scripts/z.sh</span><br></pre></td></tr></tbody></table></figure>

<p>修改第56行：执行post脚本项</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">....</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">执行 post 脚本</span></span><br><span class="line">do_cdrom_post_actions() {</span><br><span class="line">  if [[ -f /cdrom/.kylin-post-actions ]] &amp;&amp; [[ "${is_ghost}" != "true" ]]; then</span><br><span class="line">    cp /cdrom/.kylin-post-actions /target/${IN_TARGET}</span><br><span class="line">    cp -r /cdrom/option /target/${IN_TARGET}	# 新增</span><br><span class="line">    cp -r /cdrom/pks /target/${IN_TARGET}	# 新增</span><br><span class="line">    cp -r /cdrom/1108 /target/${IN_TARGET}	# 新增</span><br><span class="line">    chroot /target bash ${IN_TARGET}/.kylin-post-actions &gt;&gt;${LOG_FILE} 2&gt;&amp;1</span><br><span class="line">  fi</span><br><span class="line"></span><br><span class="line">  if [[ -f /cdrom/.kylin-post-actions-nochroot ]] &amp;&amp; [[ "${is_ghost}" != "true" ]]; then</span><br><span class="line">    bash /cdrom/.kylin-post-actions-nochroot &gt;&gt;${LOG_FILE} 2&gt;&amp;1</span><br><span class="line">  fi</span><br><span class="line">}</span><br><span class="line">....</span><br></pre></td></tr></tbody></table></figure>

<h2 id="2-3-其他文件拷贝"><a href="#2-3-其他文件拷贝" class="headerlink" title="2.3 其他文件拷贝"></a>2.3 其他文件拷贝</h2><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">拷贝pwquality.conf，该文件需事先准备，内容可见附录</span></span><br><span class="line">cp /opt/tool/pwquality.conf /opt/mylivecd/casper/squashfs-root/etc/security/</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">清空.bash_history，这里拷贝了一个文件过去，文件内容为空</span></span><br><span class="line">cp /opt/tool/.bash_history /opt/mylivecd/casper/squashfs-root/root/</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除filesystem.squashfs文件</span></span><br><span class="line">cd /opt/mylivecd/casper</span><br><span class="line">rm -rf filesystem.squashfs </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">打包squashfs-root</span></span><br><span class="line">mksquashfs squashfs-root filesystem.squashfs -comp xz</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">输出文件系统大小</span></span><br><span class="line">printf $(du -sx --block-size=1 squashfs-root |cut -f1) &gt;filesystem.size</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">进到虚拟root环境，将已安装的软件列表导出</span></span><br><span class="line">chroot squashfs-root/ dpkg-query -W &gt;filesystem.manifest</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">执行拷贝文件操作</span></span><br><span class="line">cp /opt/mylivecd/casper/filesystem.squashfs /opt/livecd/casper/</span><br><span class="line">cp /opt/mylivecd/casper/filesystem.size /opt/livecd/casper/</span><br><span class="line">cp /opt/mylivecd/casper/filesystem.manifest /opt/livecd/casper/</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">切换到livecd目录</span></span><br><span class="line">cd /opt/livecd/</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重新生成md5文件</span></span><br><span class="line">rm -rf md5sum.txt</span><br><span class="line">find -type f -print0 | xargs -0 md5sum|grep -v isolinux/boot.cat |tee md5sum.txt</span><br></pre></td></tr></tbody></table></figure>

<h1 id="三、打包ISO镜像"><a href="#三、打包ISO镜像" class="headerlink" title="三、打包ISO镜像"></a>三、打包ISO镜像</h1><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">进到livecd目录</span></span><br><span class="line">cd /opt/livecd/</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">执行打包命令</span></span><br><span class="line">mkisofs -J -r -T -joliet-long -V "Kylin-Desktop-V10-SP1" -eltorito-alt-boot -e boot/grub/efi.img -no-emul-boot -o  /opt/tool/Kylin-Desktop-V10-SP1-CC-PKS-1107.iso /opt/livecd/</span><br></pre></td></tr></tbody></table></figure>

<h1 id="四、附录"><a href="#四、附录" class="headerlink" title="四、附录"></a>四、附录</h1><p>1、pwquality.conf文件内容</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Configuration <span class="keyword">for</span> systemwide password quality limits</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Defaults:</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Number of characters in the new password that must not be present in the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">old password.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">difok = 1</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Minimum acceptable size for the new password (plus one if</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">credits are not disabled <span class="built_in">which</span> is the default). (See pam_cracklib manual.)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cannot be <span class="built_in">set</span> to lower value than 6.</span></span><br><span class="line">minlen = 6</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># The maximum credit for having digits in the new password. If less than 0</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">it is the minimum number of digits <span class="keyword">in</span> the new password.</span></span><br><span class="line">dcredit = 0</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># The maximum credit for having uppercase characters in the new password.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If less than 0 it is the minimum number of uppercase characters <span class="keyword">in</span> the new</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">password.</span></span><br><span class="line">ucredit = 0</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># The maximum credit for having lowercase characters in the new password.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If less than 0 it is the minimum number of lowercase characters <span class="keyword">in</span> the new</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">password.</span></span><br><span class="line">lcredit = 0</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># The maximum credit for having other characters in the new password.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If less than 0 it is the minimum number of other characters <span class="keyword">in</span> the new</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">password.</span></span><br><span class="line">ocredit = 0</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># The minimum number of required classes of characters for the new</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">password (digits, uppercase, lowercase, others).</span></span><br><span class="line">minclass = 1</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># The maximum number of allowed consecutive same characters in the new password.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The check is disabled <span class="keyword">if</span> the value is 0.</span></span><br><span class="line">maxrepeat = 0</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># The maximum number of allowed serial characters of the same class in the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">new password.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The check is disabled <span class="keyword">if</span> the value is 0.</span></span><br><span class="line">maxsequence = 0</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># The maximum number of allowed consecutive characters of the same class in the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">new password.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The check is disabled <span class="keyword">if</span> the value is 0.</span></span><br><span class="line">maxclassrepeat = 0</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Whether to check for the words from the passwd entry GECOS string of the user.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The check is enabled <span class="keyword">if</span> the value is not 0.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">gecoscheck = 0</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Whether to check for the words from the cracklib dictionary.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The check is enabled <span class="keyword">if</span> the value is not 0.</span></span><br><span class="line">dictcheck = 1</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Whether to check if it contains the user name in some form.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The check is enabled <span class="keyword">if</span> the value is not 0.</span></span><br><span class="line">usercheck = 1</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Whether the check is enforced by the PAM module and possibly other</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">applications.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The new password is rejected <span class="keyword">if</span> it fails the check and the value is not 0.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">enforcing = 1</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Path to the cracklib dictionaries. Default is to use the cracklib default.</span></span></span><br><span class="line">dictpath = /var/cache/cracklib/cracklib_dict</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Prompt user at most N times before returning with error. The default is 1.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">retry = 1</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Enforces pwquality checks on the root user password.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Enabled <span class="keyword">if</span> the option is present.</span></span><br><span class="line">enforce_for_root</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Skip testing the password quality for users that are not present in the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/etc/passwd file.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Enabled <span class="keyword">if</span> the option is present.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">local_users_only</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Whether to check the new password is a palindromic or not</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Enabled <span class="keyword">if</span> the option is present</span></span><br><span class="line">palindrome</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Whether to check the new password is simliar with old one</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Check include only <span class="keyword">case</span> changes and rotated</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Disabled <span class="keyword">if</span> the option is present</span></span><br><span class="line">no_similar_check</span><br></pre></td></tr></tbody></table></figure>



</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://gsproj.github.io">Haris</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://gsproj.github.io/2023/05/24/06_%E6%9D%82%E8%AE%B0/ISO%E5%AE%9A%E5%88%B6%E6%AD%A5%E9%AA%A4/">http://gsproj.github.io/2023/05/24/06_%E6%9D%82%E8%AE%B0/ISO%E5%AE%9A%E5%88%B6%E6%AD%A5%E9%AA%A4/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://gsproj.github.io" target="_blank">Haris的小站</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/%E5%A4%B4%E5%83%8F.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer=""></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2022/12/02/04_C++/01_C%E8%AF%AD%E8%A8%80/day01/" title="C语言-Day01"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">C语言-Day01</div></div><div class="info-2"><div class="info-item-1">“C语言部分-Day01” 一、第一个C程序1.1 C语言Hello World源码：helloword.c 123456#include &lt;stdio.h&gt; // 预处理指令，用于包含头文件int main(void) {	printf("HelloWorld\n");	return 0;}  1.2 文件分类主要文件分类： ​	头文件：如stdio.h ​	源文件: 如main.c ​	配置文件 ​	音视频文件 ​	图片 ​	…  Q1： 头文件指令&lt;&gt;和""的区别 &lt;xxx.h&gt;  到系统目录寻找头文件，适用于系统带的头文件 “xxx.h” 先到当前目录寻找头文件，再到系统目录寻找，适用于自己写的头文件  1.3 注释C语言的注释方式，分为单行注释和多行注释 12345678// 单行注释/*   这是多行注释   这是多行注释   这是多行注释   这是多行注释*/    1.4 C程序的编译在Linux中，C源码的编译指令如下： 12// 编译gcc...</div></div></div></a><a class="pagination-related" href="/2023/10/20/06_%E6%9D%82%E8%AE%B0/%E7%94%B2%E9%AA%A8%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%88%9D%E5%A7%8B%E8%AE%BE%E7%BD%AE/" title="甲骨云服务器初始设置"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">甲骨云服务器初始设置</div></div><div class="info-2"><div class="info-item-1">甲骨云服务器初始设置​	Oracle Cloud的服务器刚创建完是不能直接使用的，需要做一系列设置方能使用第三方ssh工具登录 1 使用私钥文件登录在创建实例的时候，保存实例私钥，  使用xshell创建SSH登录会话  选择接受  输入默认用户（centos系统默认opc，ubuntu系统默认为ubuntu）  选择私钥进行连接  登录成功  2 修改ssh服务12345678910111213141516171819202122232425262728293031# 1、切换到root用户sudo su# 2、关闭SElinux。否则修改sshd端口会报错没权限setenforce 0# 永久关闭vim /etc/selinux/config# 改成disabled# This file controls the state of SELinux on the system.# SELINUX= can take one of these three values:#     enforcing - SELinux security policy is enforced.#...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/%E5%A4%B4%E5%83%8F.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"></div><div class="author-info-name">Haris</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">215</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">32</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%AF%8D%E7%9B%98ISO%E5%AE%9A%E5%88%B6%E6%AD%A5%E9%AA%A4"><span class="toc-text">母盘ISO定制步骤</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-text">一、环境准备</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E9%95%9C%E5%83%8F%E6%96%87%E4%BB%B6%E5%92%8C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F"><span class="toc-text">1.1 镜像文件和操作系统</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E4%BF%AE%E6%94%B9%E9%95%9C%E5%83%8F%E6%96%87%E4%BB%B6"><span class="toc-text">二、修改镜像文件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E5%AF%BC%E5%85%A5%E8%A1%A5%E4%B8%81%E5%92%8C%E9%A2%84%E8%A3%85%E8%BD%AF%E4%BB%B6%E5%8C%85"><span class="toc-text">2.1 导入补丁和预装软件包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E5%AF%BC%E5%85%A5%E5%8A%9E%E5%85%AC%E6%A1%8C%E9%9D%A2"><span class="toc-text">2.2  导入办公桌面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E5%85%B6%E4%BB%96%E6%96%87%E4%BB%B6%E6%8B%B7%E8%B4%9D"><span class="toc-text">2.3 其他文件拷贝</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%89%93%E5%8C%85ISO%E9%95%9C%E5%83%8F"><span class="toc-text">三、打包ISO镜像</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E9%99%84%E5%BD%95"><span class="toc-text">四、附录</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/14/06_%E6%9D%82%E8%AE%B0/%E5%8D%8E%E4%B8%BAUSG6615F%E9%98%B2%E7%81%AB%E5%A2%99%E9%85%8D%E7%BD%AESSL%20VPN/" title="华为USG6615F防火墙配置SSLVPN">华为USG6615F防火墙配置SSLVPN</a><time datetime="2025-05-14T07:00:52.000Z" title="发表于 2025-05-14 15:00:52">2025-05-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/06/10_%E5%AD%A6%E7%A5%9EK8S/01-Docker%E5%9F%BA%E7%A1%80/01-Dokcer%E5%9F%BA%E7%A1%80/" title="01-Docker基础">01-Docker基础</a><time datetime="2025-05-06T05:52:52.000Z" title="发表于 2025-05-06 13:52:52">2025-05-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/30/06_%E6%9D%82%E8%AE%B0/vllm%E9%83%A8%E7%BD%B2Qwen3%E5%A4%A7%E6%A8%A1%E5%9E%8B/" title="VLLM部署Qwen3大模型">VLLM部署Qwen3大模型</a><time datetime="2025-04-30T07:15:52.000Z" title="发表于 2025-04-30 15:15:52">2025-04-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/21/06_%E6%9D%82%E8%AE%B0/%E5%8D%8E%E4%B8%BA%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%85%8D%E7%BD%AEmux-vlan/" title="华为交换机配置mux-vlan">华为交换机配置mux-vlan</a><time datetime="2025-04-21T08:29:52.000Z" title="发表于 2025-04-21 16:29:52">2025-04-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/21/06_%E6%9D%82%E8%AE%B0/ollama%E9%83%A8%E7%BD%B2deepseek%E5%A4%A7%E6%A8%A1%E5%9E%8B/" title="8卡A800运行DeepseekR1-671B大模型">8卡A800运行DeepseekR1-671B大模型</a><time datetime="2025-04-21T06:29:52.000Z" title="发表于 2025-04-21 14:29:52">2025-04-21</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent;"><div id="footer-wrap"><div class="copyright">©2019 - 2025 By Haris</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><div class="js-pjax"></div><script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>